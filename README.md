# SNN-TLM
This is a SystemC TLM model of a **spiking neural network (SNN)** that implements a **fully connected feedforward network** with three layers. The network uses **leaky integrate-and-fire (LIF) neurons** and **event-driven computation**. The network parameters and input spikes are parsed from files generated by a PyTorch-based SNN simulator.

## Files
The code consists of the following files:

- `top_level.cpp`: This file contains the **top-level module** of the SNN model, which instantiates and connects the submodules for each layer and the event controller. The submodules include **memory objects** that store the weights and biases, **accumulator objects** that perform the dot product between the input spikes and the weights, and **activation objects** that implement the LIF neuron dynamics and generate output spikes. The event controller is responsible for coordinating the computation and communication between the layers based on the availability of input spikes and output buffers.
- `event_control.cpp`: This file contains the implementation of the **event controller module**, which consists of three threads that control the flow of events for each layer. The event controller reads the input spikes from a file and distributes them to the first layer. It also reads the bias values from files and adds them to the accumulator outputs. It monitors the buffer availability and triggers the activation of each layer when the buffer is full. It also writes the output spikes of the last layer to a file and prints the simulation time.
- `defines.h`: This file contains the **global definitions and constants** used by the SNN model, such as the layer sizes, memory unit sizes, neuron parameters, file names, etc.
- `neuron_repl.cpp`: This file contains a utility program that replicates a single neuron module to generate multiple neuron modules with different parameters. It takes four arguments: layer number, neuron unit size, memory unit size, and number of neurons to replicate. It outputs a header file and a source file for each replicated neuron module.
- `sntorch_parsing_fc*.cpp`: These files contain utility programs that parse the raw data files generated by the PyTorch-based SNN simulator and convert them into weight and bias files that can be read by the memory objects. They take four arguments: layer number, neuron unit size, memory unit size, and whether to use bias or not. They output multiple weight files and one bias file for each layer.
- `makefile`: This file contains rules for compiling and running the SNN model and the utility programs.
- `custom_run.sh`: This file contains a shell script that automates the process of generating neuron modules, parsing data files, compiling and running the SNN model.

## Usage
To run the SNN model, follow these steps:

1. Make sure you have SystemC installed on your system and set the `SYSTEMC` environment variable to point to its installation directory.
2. Run `./custom_run.sh` to execute the shell script that will generate neuron modules, parse data files, compile and run the SNN model.
3. Wait for the simulation to finish and check the output file `trace_log.txt` for the simulation time and output spikes.

Alternatively, you can run each step manually using the commands in `custom_run.sh`.

## License
This code is released under the MIT license. See LICENSE.txt for more details.
